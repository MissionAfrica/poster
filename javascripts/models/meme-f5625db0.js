MEME.MemeModel=Backbone.Model.extend({defaults:{backgroundPosition:{x:null,y:null},creditText:"Source:",creditSize:12,downloadName:"share",dragging:null,fontColor:"white",fontFamily:"Helvetica Neue",fontFamilyOpts:["Helvetica","Helvetica Neue","Comic Sans MS"],fontSize:24,fontSizeOpts:[14,24,36],footerSrc:"",headlineText:"Write your own headline",height:378,imageScale:1,imageSrc:"",overlayAlpha:.5,overlayColor:"#000",overlayColorOpts:["#000","#777","#2980b9"],paddingRatio:.05,roundel:!1,roundelPosition:{x:null,y:null},textAlign:"left",textAlignOpts:["left","center","right"],textShadow:!0,textShadowEdit:!0,watermarkAlpha:1,watermarkMaxWidthRatio:.25,watermarkSrc:"",watermarkOpts:[],width:755},initialize:function(){this.background=new Image,this.watermark=new Image,this.footer=new Image,this.background.onload=this.watermark.onload=_.bind(function(){this.trigger("change")},this),this.get("imageSrc")&&(this.background.src=this.get("imageSrc")),this.get("watermarkSrc")&&this.setWatermarkSrc(this.get("watermarkSrc")),this.get("footerSrc")&&this.setFooterSrc(this.get("footerSrc")),this.listenTo(this,"change:imageSrc",function(){this.background.src=this.get("imageSrc")}),this.listenTo(this,"change:watermarkSrc",function(){this.setWatermarkSrc(this.get("watermarkSrc"))})},hasBackground:function(){return this.background.width&&this.background.height},hasRoundel:function(){return this.attributes.roundel},loadFileForImage:function(t,e){var r=new FileReader;r.onload=function(){e.src=r.result},r.readAsDataURL(t)},loadBackground:function(t){this.loadFileForImage(t,this.background)},loadWatermark:function(t){this.loadFileForImage(t,this.watermark)},loadFooter:function(t){this.loadFileForImage(t,this.footer)},setWatermarkSrc:function(t){var e=_.findWhere(this.get("watermarkOpts"),{value:t}),r=e&&e.data||t;0===r.indexOf("data:")?this.watermark.removeAttribute("crossorigin"):this.watermark.setAttribute("crossorigin","anonymous"),this.watermark.src=r,this.set("watermarkSrc",t)},setFooterSrc:function(t){var e=_.findWhere(this.get("footerOpts"),{value:t}),r=e&&e.data||t;0===r.indexOf("data:")?this.footer.removeAttribute("crossorigin"):this.footer.setAttribute("crossorigin","anonymous"),this.footer.src=r,this.set("footerSrc",t)}});